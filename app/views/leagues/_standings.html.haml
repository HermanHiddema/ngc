- teams = league.teams.to_a.sort_by{|t| [t.score, t.points]}.reverse
%table
	%tr
		%th{colspan:3}
		- teams.each do |team|
			%th= team.abbrev
		%th WP
		%th BP
	- teams.each do |team|
		%tr
			%th{colspan:3}= link_to team.name, team
			- teams.each do |team2|
				- if team == team2
					%td
						&times;
				- else
					- match = team.matches.select { |m| m.opponent(team).id == team2.id }.try(&:first)
					- if match.nil?
						%td
					- elsif match.played?
						- if match.black_team.id == team.id
							%td{class: match.black_score > 0 ? 'won' : 'lost'}
								= link_to match.black_points, match
						- else
							%td{class: match.white_score > 0 ? 'won' : 'lost'}
								= link_to match.white_points, match
					- else
						%td
							%small
								= link_to (match.playing_date.strftime("%e/%-m")), edit_match_path(match), title: match.venue.try(:name)
			%th= team.score
			%th= team.points
